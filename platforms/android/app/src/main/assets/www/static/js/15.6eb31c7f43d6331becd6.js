webpackJsonp([15],{"5YJA":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Xxa5"),o=a.n(n),i=a("exGp"),s=a.n(i),c=a("7+uW"),r=a("Fd2+"),l=a("M5WX"),u={components:{"float-icons":a("J/Nn").a},methods:{handleIcons:function(t){this.$parent.openPoint()}}},d={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("float-icons",{staticClass:"icons-warp",attrs:{padding:"10 10 60 10"}},[n("div",{staticClass:"float-icon-item",on:{click:function(e){return t.handleIcons("Feedback")}}},[n("img",{attrs:{src:a("Es8T"),alt:""}})])])],1)},staticRenderFns:[]};a("VU/8")(u,d,!1,function(t){a("HtNn")},"data-v-6826a473",null).exports;c.default.use(r.J),c.default.use(r.l);var g={data:function(){return{TaskList:[],carId:"",timeOutEvent:0,lng:"",lat:"",open:!1,show:!1,station:"",radio:"",checkData:[],routingName:""}},methods:{queryBtn:function(){this.open=!0},openPoint:function(){this.open=!0},addPointFunc:function(){this.open=!1;var t=this;if(""===t.radio)Object(r.J)("当前数据为空，无法创建点位数据！");else{this.$http.post("/mobile/point",{pollutantName:t.station,routingName:t.$store.state.routingName,dataId:t.radio}).then(function(e){console.log(e),t.checkStatus(),t.radio=""}).catch(function(t){console.log(t)})}},selectDataPicStation:function(){this.open=!1;var t=this;new PickerView({bindElem:classPicstation,data:this.$store.state.enterpriseNum,title:"选择点位",leftText:"取消",rightText:"确定",rightFn:function(e){switch(console.log(e[0]),e[0]){case"其他":t.show=!0;break;default:t.station=e[0],t.open=!0}}})},getposition:function(t){var e=this;navigator.vibrate(500);var a={msg:""};navigator.geolocation.getCurrentPosition(function(t){console.log("position",t);var a=coordtransform.wgs84togcj02(Number(t.coords.longitude),Number(t.coords.latitude));console.log(a),e.lng=a[0],e.lat=a[1],e.getGaoDE(a[0],a[1])},function(t){a.msg="code: "+t.code+"\nmessage: "+t.message+"\n",alert(a.msg),console.log(a.msg)},{maximumAge:3e4,timeout:3e4,enableHighAccuracy:!0})},getGaoDE:function(t,e){var a,n=this,o=new AMap.LngLat(Number(t),Number(e));function i(t){console.log("params",t),n.address=t.regeocode.formattedAddress}AMap.plugin(["AMap.Geocoder"],function(){a=new AMap.Geocoder({radius:1e3,extensions:"all"}),AMap.event.addListener(a,"complete",i),a.getAddress(o)})},onConfirm:function(){alert(1)},gtouchstart:function(){var t=this;this.timeOutEvent=setTimeout(function(){t.timeOutEvent=0},3e3)},gtouchmove:function(){clearTimeout(this.timeOutEvent),this.timeOutEvent=0},gtouchend:function(){clearTimeout(this.timeOutEvent),this.timeOutEvent=0},checkStatus:function(){var t=this;return s()(o.a.mark(function e(){var a,n;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="/mobile/routing/check",e.next=3,l.a.request(a,"GET",{},t.token);case 3:n=e.sent,console.log(n),t.TaskList=n.data.data.monitoringDataList,t.carId=n.data.data.vehicleId;case 7:case"end":return e.stop()}},e,t)}))()},endTask:function(){var t=this;return s()(o.a.mark(function e(){var a,n,i;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=t,0===t.TaskList.length?r.l.confirm({title:"删除路线提示",message:"当前路线点位为空，我们会帮你删除当前路线"}).then(function(){var e={routingName:t.$store.state.routingName};t.$http.delete("/mobile/routing",{params:e}).then(function(t){console.log(t),a.$store.state.taskStatus=0,"success"===t.data.message&&(Object(r.J)("当前路线已经删除,请返回重新创建路线"),a.$router.go(-2))}).catch(function(t){console.log(t)})}).catch(function(){Object(r.J)("路线还在,您继续进行您的任务！")}):(a=t,n=t.$store.state.routingName,i="/mobile/routing/finish?routingName="+n,t.$http.post(i,{routingName:n}).then(function(t){console.log(t),a.$router.go(-2),a.$store.commit("pointDataList",[]),Object(r.J)("任务已经完成"),a.$store.state.taskStatus=0}).catch(function(t){console.log(t),Object(r.J)("任务结束失败")}));case 2:case"end":return e.stop()}},e,t)}))()},btnNextNavigate:function(t,e,a,n){console.log(t,a),this.station=t,this.routingName=e,this.radio=a,this.open=!0},closeThis:function(t,e){console.log(t);var a=this;r.l.confirm({title:"",message:"确认删除当前点位？"}).then(function(){console.log(t),a.TaskList.splice(t,1),a.initDeleteData(e)}).catch(function(){})},AddStation:function(){Object(r.J)("新增点位"),console.log(this.$store.state),this.$router.push({path:"/stationEdit",query:{}})},initDeleteData:function(t){var e=this;return s()(o.a.mark(function a(){var n,i;return o.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:n="/mobile/point",t,i={id:t},e.$http.delete(n,{params:i}).then(function(t){console.log(t),"success"===t.data.message&&Object(r.J)("当前点位已经删除,请返回重新创建点位")}).catch(function(t){console.log(t)});case 4:case"end":return a.stop()}},a,e)}))()},submitData:function(){this.$http.post(url,{pollutantName:this.station,routingName:this.routingName,dataId:this.radio}).then(function(t){console.log(t)}).catch(function(t){console.log(t)})},initData:function(){var t=this;return s()(o.a.mark(function e(){var a,n,i,s;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t,n="/mobile/point/data",i=t.$store.state.vehicleIdStatus,e.next=5,l.a.request(n,"GET",{vehicleId:i},t.token);case 5:s=e.sent,console.log(s.data.data),a.checkData=s.data.data;case 8:case"end":return e.stop()}},e,t)}))()}},mounted:function(){this.token=sessionStorage.getItem("token"),this.checkStatus(),this.initData()}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-nav-bar",{staticClass:"backgroundNaviBar",attrs:{fixed:!0,title:"创建点位","left-arrow":"","z-index":"999",border:!1},on:{"click-left":function(){t.$router.go(-1)},"click-right":t.queryBtn}},[a("van-icon",{attrs:{slot:"right",name:"add",size:"20"},slot:"right"})],1),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"contHeader"},t._l(t.TaskList,function(e,n){return a("van-swipe-cell",{key:n,staticClass:"borderBottom"},[a("van-cell-group",{staticStyle:{"border-radius":"10px"},on:{click:function(a){return t.btnNextNavigate(e.pollutantName,e.routingName,e.id,t.carId)}}},[a("van-cell",{attrs:{title:"名称："+e.pollutantName,label:e.gmtCreate,border:!1}})],1),t._v(" "),a("template",{slot:"right"},[a("van-button",{staticStyle:{height:"65px"},attrs:{square:"",type:"danger",text:"删除"},on:{click:function(a){return t.closeThis(n,e.id)}}})],1)],2)}),1)]),t._v(" "),a("div",{staticClass:"btnSubmitTask"},[a("div",{staticClass:"borderCircle",on:{click:t.endTask}},[a("span",[t._v("结束当前任务")])])]),t._v(" "),a("mu-container",[a("mu-bottom-sheet",{attrs:{open:t.open},on:{"update:open":function(e){t.open=e}}},[a("mu-list",[a("div",{staticClass:"containerMain"},[a("div",{staticClass:"flexContainer"},[a("div",{staticClass:"titleselect"},[a("span",[t._v("点位名称：")])]),t._v(" "),a("div",{staticClass:"select",attrs:{id:"classPicstation"},on:{click:t.selectDataPicStation}},[a("div",{staticStyle:{flex:"1"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.station,expression:"station"}],staticClass:"input",attrs:{type:"text",placeholder:"请输入当前的站点名称",disabled:""},domProps:{value:t.station},on:{input:function(e){e.target.composing||(t.station=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"imageSize"},[a("img",{attrs:{src:"static/img/toBottom.png",alt:""}})])])])]),t._v(" "),t._l(t.checkData,function(e,n){return a("van-radio-group",{key:n,model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[a("van-cell-group",[a("van-cell",{attrs:{title:e.gmtCreate,clickable:""},on:{click:function(a){t.radio=e.id}}},[a("van-radio",{attrs:{slot:"right-icon",name:e.id},slot:"right-icon"})],1)],1)],1)})],2),t._v(" "),a("van-button",{staticClass:"backgroundNaviBar",attrs:{color:t.$store.state.color,size:"large"},on:{click:t.addPointFunc}},[t._v("提交点位")])],1)],1),t._v(" "),a("van-dialog",{staticClass:"titleColor",attrs:{title:"请手动输入污染源名称","show-cancel-button":""},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("div",{staticClass:"select centerBorder",staticStyle:{height:"60px"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.station,expression:"station"}],staticClass:"input border",staticStyle:{width:"80%"},attrs:{type:"text",placeholder:"请输入您的污染源名称"},domProps:{value:t.station},on:{input:function(e){e.target.composing||(t.station=e.target.value)}}})])])],1)},staticRenderFns:[]};var h=a("VU/8")(g,m,!1,function(t){a("wZUg")},"data-v-640cc549",null);e.default=h.exports},Es8T:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAD5klEQVRoQ92aTYgcRRTH/6/Z7o1fd3EhuSgIOa2gJ+P0uJqAbjyFHAMbRQ+imY4fIV6Ml4REsz1RclA0SwK56EmyCmrW6VFPCu5FdA9zUVjxrBLd6qX+UrMz4+5meqordk/SDjQz0K/ee7+p11Wv3mtBQZ+wmT4sxBManBJiChhcxsKquShY9SDm+9Ok4X9ThGn5L0oemf97ryfyOCEHBdjpoovALwJ+qMkvvjq643OXsZtlnQHC87yTKp0TwRyI6Rs1vGWcYJnEggT+QvK8/OmiMzdAeJ53U63PCfRhQO51MZJflh3CuyDBhAH5Lc+4XAD1eP1JQjcBlOT4da52BF6jFU18YoOwAoRN9TSI922KSrkveCZpBB+M0j0SoB6nrxI8XYpzOZUK5Fgr8s9kiWcC1OaVeVAv5LRTqhiJw+2jwcIwI0MBaufSumh+WapXjsrpyaPtI35r+7DrAGpN9aAQ3zrqH4s4BQ+1G8F3mfuAWSqxploQuX8sHrkaIVcwGdQ3L7FbZqAWp8cFPOmqd5zyhLzWjvxTfZsDALPDQqnlEjapvwDcVhwkOwiC6f6OPQCoxeoFAd4u0lASTd5n9NXitY8F8lRRugm82I6Cd4y+f2egqb4vLLcxmjXfSF6aPGF+hmfXTsCT14sCgGA5aQQPDADC5vosqK8UZqBsgK7n3v6kMbHYnYFarN4V4NkqARB4rx0Fz3UB6s10leQ9VQIQkV9bDX9K6ufSGWpeLdT5cYRQN4rkManH6UmCxysJADkltVhdFOBQFQEIXJJwXl2FYKaKACCWDMBPEDjlPgL5iFr/aIPesg/YhD05AGC3TWzLfWLFAPwOwV15BwpwrRUFd+SVd5ELY0UXeRB/OAMYA0kUWI+iTo70hMNYXXPKm3oAziEEsAONyzYnXUKIHqad86VeCFX7Ia78Mlr5jcwUZUF+bYtn5/tlptN9Z0T29LPRn12Ls1agkgFMcbgdBbu6AGG89iYgL1udchEoGQDgW0k0+UoXYKNM7n3m4p9VtmQATb3PlOX/H0fK3qms0EO9yZdakX9wI0TVD855zogpHn6oL6GsYvImArdbw81JIKOssjELFS5sdafalBZVavaEcTUynP57AB0E/p7M0qLR1uvGLLpqHoe8wJvd3rUZmhbf1K5M1j+R0a3JzOtvhe7MIGMY0aUZeTC5Fbo0o7ozBtB6srqZ3ZqsrszmKLMCdJdX07XRvDS2xge5Qk8Obe/GDHs8cgH0l9jKNro3k1f2VYNh02fK8qTe74nMuhaHTXFWk4si3hVTJr/RfSR3CNkMmCIxNGbyvG4DD0utI/6STWee+/8AAYwNlMAWyE0AAAAASUVORK5CYII="},HtNn:function(t,e){},wZUg:function(t,e){}});
//# sourceMappingURL=15.6eb31c7f43d6331becd6.js.map