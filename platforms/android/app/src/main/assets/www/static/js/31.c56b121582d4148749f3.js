webpackJsonp([31],{nkqY:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("Xxa5"),n=i.n(s),a=i("Dd8w"),o=i.n(a),r=i("exGp"),l=i.n(r),c=i("Fd2+"),h=(i("tY+N"),i("iIbB")),d=i("qIFp"),u=i("M5WX"),m=i("7+uW");m.default.use(c.g).use(c.h).use(c.x).use(c.t),m.default.use(c.J);var v=document.documentElement.clientHeight||document.body.clientHeight,g=Math.floor((v-90-56)/58),p={name:"warningControl",data:function(){return{showChecked:!1,checked:"",refreshing:!1,loading:!1,listWarningContent:[],token:"",panel:"",content:[],openSimple:!1,open:!1,value1:u.a.DateTime(7),value2:u.a.filter(new Date),options:[],normal:{value1:""},styleHandle:"border-bottom-color:"+this.$store.state.color+";color:"+this.$store.state.color,showHandled:!1,showNoHandled:!1,styleNoHandle:"border-bottom-color:"+this.$store.state.color+";color:"+this.$store.state.color,list:[],openTime:!1,currentDate:new Date,minDate:new Date("1970-07-01"),Time:"",currentPage:1,sizeContent:0,pageSizeCont:g,sizeContentAll:100,warningType:"因子超标预警",warningTypeArr:["因子超标预警","设备异常预警","数据因子缺失","数据丢失"],arrIndexList:[],timePermision:0,startTimeSelect:0,times:0,total:0,showSubmit:!0,showover:!1,undo:0}},created:function(){this.user=sessionStorage.getItem("user"),"manager"===this.user&&(this.showSubmit=!1,this.warningTypeArr=["因子超标预警"]),this.showover=!0},methods:{showCheckedFunc:function(){this.showChecked=!this.showChecked,this.clearData()},checkedData:function(t,e,i){this.arrIndexList;var s=0;if(0===this.arrIndexList.length){this.startTimeSelect=0,this.startTimeSelect=Number(new Date(i)),this.timePermision=Number(new Date(i))-216e5;for(var n=this.listWarningContent,a=0;a<n.length;a++){n[a].color;var o=n[a].gmtModified,r=Number(new Date(o));r>=this.timePermision&&r<=this.startTimeSelect?n[a].color="background:white":(n[a].color="background:rgb(233, 233, 233)",n[a].img="static/imgs/noChecked.png")}this.listWarningContent=n,this.warningDataSelect(e,t)}else if(this.arrIndexList.length>=1)if((s=Number(new Date(i)))>=this.timePermision&&s<=this.startTimeSelect)this.warningDataSelect(e,t);else{Object(c.J)("批量处理只可以连续处理6个小时内！")}},handleWarning:function(){var t=!1;"manager"!==this.user?(this.arrIndexList.length>1&&(this.$store.commit("warningIdListCommit",this.arrIndexList),t=!0),this.$router.push({path:"/TwoHandle",query:{id:"",status:t}})):Object(c.J)("您只可以查看")},clearData:function(){for(var t=this.listWarningContent,e=0;e<t.length;e++)t[e].color="background:white",t[e].img="static/imgs/checkedNo.png";this.listWarningContent=t,!1===this.showChecked&&(this.arrIndexList=[],this.$store.commit("warningIdListCommit",this.arrIndexList),this.timePermision=0,this.startTimeSelect=0)},warningDataSelect:function(t,e){!0===this.listWarningContent[t].showIndex?(this.listWarningContent[t].showIndex=!1,this.listWarningContent[t].img="static/imgs/checkedNo.png",this.arrIndexList.splice(t,1),0===this.arrIndexList.length&&(this.clearData(),this.showCheckedFunc())):(this.listWarningContent[t].showIndex=!0,this.listWarningContent[t].img="static/imgs/checked.png",this.arrIndexList.push({index:t,warningId:e.warningId}))},refresh:function(){this.refreshing=!0,this.$refs.container.scrollTop=0,this.refreshing=!1,this.pageSizeCont=g,this.initData()},load:function(){this.loading=!0,this.loading=!1,this.pageSizeCont+=10,this.initData()},selectDataclassType:function(){this.open=!1;var t=this;new PickerView({bindElem:classType,data:this.warningTypeArr,title:"选择预警类型",leftText:"取消",rightText:"确定",rightFn:function(e){t.warningType=e[0],t.open=!0}})},selectDataPicoptions:function(){this.open=!1;var t=this;new PickerView({bindElem:classPicoptions,data:this.$store.state.menu,title:"选择站点",leftText:"取消",rightText:"确定",rightFn:function(e){t.normal.value1=e[0],t.$store.state.warningStation=e[0],t.open=!0}})},close:function(){this.openTime=!1,this.value1=null,this.value2=null,this.normal.value1=null,this.initData()},confirmTime:function(t){switch(this.openTime=!1,this.Time){case"start":this.value1=u.a.filter(t),this.$store.commit("startTimeCommit",this.value1);break;case"end":this.value2=u.a.filter(t),this.$store.commit("lastTimeCommit",this.value2)}},closeBottomSheetTime:function(){this.openTime=!1},selectStartTime:function(t){this.openTime=!0,this.Time=t},selectLastTime:function(t){this.Time=t,this.openTime=!0},handled:function(){if(this.showHandled=!this.showHandled,this.showHandled){var t=this.$store.state.handle;this.styleHandle="color:#ccc;border:none",this.showNoHandled?this.listWarningContent=[]:this.listWarningContent=d.a.Processed(t,0)}else{t=this.$store.state.handle;this.styleHandle="",this.showNoHandled?this.listWarningContent=d.a.Processed(t,1):this.listWarningContent=t}},nohandled:function(){var t=this.$store.state.handle;this.showNoHandled=!this.showNoHandled,this.showNoHandled?(this.styleNoHandle="color:#ccc;border:none",this.showHandled?this.listWarningContent=[]:this.listWarningContent=d.a.Processed(t,1)):(this.styleNoHandle="",this.showHandled?this.listWarningContent=d.a.Processed(t,0):this.listWarningContent=t)},closeBottomSheet:function(){this.open=!1,this.value1=null,this.value2=null,this.normal.value1=null,this.initData()},openBotttomSheet:function(){this.open=!0},backTonoHandleNo:function(t){"manager"!==this.user?this.$router.push({path:"/TwoHandle",query:{id:t,status:!1}}):Object(c.J)("您只可以查看")},handledTo:function(t){var e=!1;"manager"!==this.user?"批量处理"===t&&this.arrIndexList.length>0?this.arrIndexList.length>1&&(this.$store.commit("warningIdListCommit",this.arrIndexList),e=!0,this.$router.push({path:"/TwoHandle",query:{id:t,status:e}})):Object(c.J)("请选择您要处理的内容！"):Object(c.J)("您只可以查看")},toggle:function(t,e){this.panel=t===this.panel?"":t,this.content=h.a.warningContent(this.listWarningContent,e)},backTonoHandle:function(t,e){this.$router.push({path:"/Handle",query:{id:t,startTime:this.value1,lastTime:this.value2,waterStation:this.normal.value1,pageSize:this.pageSizeCont,pageNum:this.currentPage,warningType:this.warningType,index:e}})},toBack:function(){this.user,this.$router.go(-1),this.$store.state.lastTime="",this.$store.state.startTime=""},initData:function(){var t=this;return l()(n.a.mark(function e(){var i,s,a,r,l,c,h,d,m,v,g,p,w,C;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.open=!1,t,i="/warning/list",s=""!==t.$store.state.warningStation?t.$store.state.warningStation:t.normal.value1,0,""!==t.$store.state.startTime?(a=t.$store.state.startTime,r=t.$store.state.lastTime,t.value1=a,t.value2=r):(a=t.value1,r=t.value2,t.$store.commit("startTimeCommit",t.value1),t.$store.commit("lastTimeCommit",t.value2)),t.$store.commit("warningStationHandle",s),l=t.pageSizeCont,c=t.currentPage,h=t.warningType,e.next=12,u.a.request(i,"POST",{waterStation:s,starttime:a,lasttime:r,pageSize:l,pageNum:c,warningType:h},t.token);case 12:for(d=e.sent,console.log("res",d),t.undo=d.data.data.undo,t.showover=!1,m=d.data.data.total,t.sizeContentAll=m,t.sizeContent=Math.floor(m/t.pageSizeCont),t.$store.commit("warningContent",d.data.data.data),v=[],v=d.data.data.data,t.total=d.data.data.total,g=[],p=[],w=0;w<v.length;w++)C={showIndex:!1,img:"static/imgs/checkedNo.png",color:"#CCC"},g=o()({},v[w],C),p.push(g);t.listWarningContent=p,t.list=t.listWarningContent;case 28:case"end":return e.stop()}},e,t)}))()}},mounted:function(){this.user=sessionStorage.getItem("user"),this.token=sessionStorage.getItem("token"),this.options=this.$store.state.menu,""!==this.$route.query.stationName&&void 0!==this.$route.query.stationName&&null!==this.$route.query.stationName?(this.$store.state.warningStation="",this.normal.value1=this.$route.query.stationName):this.normal.value1=this.$store.state.menu[0],this.initData()}},w={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("van-nav-bar",{staticClass:"backgroundNaviBar",attrs:{fixed:!0,title:t.$store.state.warningStation,"left-arrow":"","z-index":"999",border:!1},on:{"click-left":function(){t.$router.go(-1)},"click-right":function(){t.open=!0}}},[i("van-icon",{attrs:{slot:"right",name:"filter-o",size:"20"},slot:"right"})],1),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!0===t.showSubmit,expression:"showSubmit===true"}],staticClass:"positionF"},[i("div",{staticClass:"flexContentHeader",staticStyle:{padding:"0 10px",background:"white","border-radius":"10px"}},[i("div",{staticClass:"flexContainerR",staticStyle:{flex:"2"}},[i("span",{staticStyle:{"margin-right":"10px"}},[t._v("预警条数")]),t._v(" "),i("span",{staticStyle:{color:"red"}},[t._v(t._s(t.total)+" 条")])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!1===t.showSubmit,expression:"showSubmit===false"}],staticStyle:{flex:"2"}},[i("span",[t._v("未处理条数：")]),t._v(" "),i("span",{staticStyle:{color:"red"}},[t._v(t._s(t.undo)+" 条")])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!0===t.showSubmit,expression:"showSubmit===true"}],staticClass:"btnHandleWarning",staticStyle:{flex:"2"}},[i("span",{staticClass:"piliang",staticStyle:{"margin-right":"10px"},on:{click:t.showCheckedFunc}},[t._v("批量处理")]),t._v(" "),i("span",{staticClass:"rightSumbit backgroundNaviBar",on:{click:function(e){return t.handledTo("批量处理")}}},[t._v("提交")])])])]),t._v(" "),i("div",{staticClass:"warningContent"},[i("div",{staticClass:"border-radius",staticStyle:{padding:"0 10px",background:"white",margin:"10px",height:"100%"}},[i("mu-container",{ref:"container"},[i("mu-load-more",{attrs:{refreshing:t.refreshing,loading:t.loading},on:{refresh:t.refresh,load:t.load}},t._l(t.listWarningContent,function(e,s){return i("mu-expansion-panel",{key:s,staticClass:"boxShow",staticStyle:{padding:"0 10px"},attrs:{expand:t.panel==="panel1"+s},on:{change:function(e){return t.toggle("panel1"+s,s)}}},[i("div",{staticClass:"headerListAlert",staticStyle:{color:"rgb(129, 119, 119)"},attrs:{slot:"header"},slot:"header"},[i("div",{staticClass:"checkedTitle"},[i("img",{directives:[{name:"show",rawName:"v-show",value:t.showChecked,expression:"showChecked"}],attrs:{src:e.img,alt:""},on:{click:function(i){return t.checkedData(e,s,e.gmtModified)}}}),t._v(" "),i("span",[t._v(t._s(e.warningType))])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!0===t.showSubmit,expression:"showSubmit===true"}]},[i("button",{directives:[{name:"show",rawName:"v-show",value:0===e.warningStatus,expression:"item.warningStatus===0"}],staticClass:"btnStyles",on:{click:function(i){return t.backTonoHandleNo(e.warningId)}}},[t._v("未处理")]),t._v(" "),i("button",{directives:[{name:"show",rawName:"v-show",value:2===e.warningStatus,expression:"item.warningStatus===2"}],staticClass:"btnStylesHandled",on:{click:function(i){return t.backTonoHandle(e.warningId,s)}}},[t._v("已处理")]),t._v(" "),i("button",{directives:[{name:"show",rawName:"v-show",value:1===e.warningStatus,expression:"item.warningStatus===1"}],staticClass:"btnStylesHandlding"},[t._v("正在处理")])])]),t._v(" "),i("div",[i("div",{staticClass:"bettweenFlexBack"},[i("div",{staticClass:"bettweenFlex"},[i("span",[t._v("编号")]),t._v(" "),i("span",[t._v(t._s(e.warningId))])]),t._v(" "),i("div",{staticClass:"bettweenFlex"},[i("span",[t._v("预警时间")]),t._v(" "),i("span",[t._v(t._s(e.gmtModified))])]),t._v(" "),i("div",{staticClass:"bettweenFlex"},[i("span",[t._v("预警站点")]),t._v(" "),i("span",[t._v(t._s(e.warningStation))])]),t._v(" "),i("div",{staticClass:"bettweenFlex"},[i("span",[t._v("预警类型")]),t._v(" "),i("span",[t._v(t._s(e.warningType))])]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!0===t.showSubmit,expression:"showSubmit===true"}],staticClass:"bettweenFlex"},[i("div",[t._v("处理状态")]),t._v(" "),i("div",[0===e.warningStatus?i("span",{staticClass:"btnStylesCont"},[t._v("未处理")]):t._e(),t._v(" "),1===e.warningStatus?i("span",{staticClass:"btnStylesHandledCont"},[t._v("已处理")]):t._e()])]),t._v(" "),i("div",[i("span",[t._v("预警内容")])]),t._v(" "),i("div",{staticClass:"paddingContent"},t._l(t.content,function(e,s){return i("div",{key:s,staticClass:"panelContent"},[i("div",{staticClass:"bettweenFlex"},[i("span",[t._v(t._s(e[0].name))]),t._v(" "),i("span",{staticStyle:{color:"red"}},[t._v(t._s(e[0].value))])])])}),0)])])])}),1)],1),t._v(" "),i("mu-container",[i("mu-bottom-sheet",{staticClass:"queryPadding",attrs:{open:t.open},on:{"update:open":function(e){t.open=e}}},[i("mu-list",{on:{"item-click":t.closeBottomSheet}},[i("mu-list-item",[i("div",{staticClass:"titleselect"},[i("span",[t._v("站点名称：")])]),t._v(" "),i("div",{staticClass:"select",attrs:{id:"classPicoptions"},on:{click:t.selectDataPicoptions}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.normal.value1,expression:"normal.value1"}],staticClass:"input",attrs:{type:"text",placeholder:"请选择站点",disabled:""},domProps:{value:t.normal.value1},on:{input:function(e){e.target.composing||t.$set(t.normal,"value1",e.target.value)}}}),t._v(" "),i("img",{attrs:{src:"static/img/toBottom.png",alt:"",srcset:""}})])]),t._v(" "),i("mu-list-item",[i("div",{staticClass:"titleselect"},[i("span",[t._v("预警类型：")])]),t._v(" "),i("div",{staticClass:"select",attrs:{id:"classType"},on:{click:t.selectDataclassType}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.warningType,expression:"warningType"}],staticClass:"input",attrs:{type:"text",placeholder:"请选择预警类型",disabled:""},domProps:{value:t.warningType},on:{input:function(e){e.target.composing||(t.warningType=e.target.value)}}}),t._v(" "),i("img",{attrs:{src:"static/img/toBottom.png",alt:"",srcset:""}})])]),t._v(" "),i("mu-list-item",[i("div",{staticClass:"titleselect"},[i("span",[t._v("开始时间：")])]),t._v(" "),i("div",{staticClass:"select",on:{click:function(e){return t.selectStartTime("start")}}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.value1,expression:"value1"}],staticClass:"input",attrs:{type:"text",disabled:""},domProps:{value:t.value1},on:{input:function(e){e.target.composing||(t.value1=e.target.value)}}})])]),t._v(" "),i("mu-list-item",[i("div",{staticClass:"titleselect"},[i("span",[t._v("结束时间：")])]),t._v(" "),i("div",{staticClass:"select",on:{click:function(e){return t.selectLastTime("end")}}},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.value2,expression:"value2"}],staticClass:"input",attrs:{type:"text",disabled:""},domProps:{value:t.value2},on:{input:function(e){e.target.composing||(t.value2=e.target.value)}}})])]),t._v(" "),i("mu-list-item",[i("div",{staticClass:"btnBottom"},[i("div",{staticClass:"left",on:{click:function(e){return t.closeBottomSheet()}}},[t._v("取消")]),t._v(" "),i("div",{staticClass:"right backgroundNaviBar",style:"background:"+t.$store.state.color,on:{click:function(e){return t.initData()}}},[t._v("确定")])])])],1)],1)],1),t._v(" "),i("mu-container",[i("mu-bottom-sheet",{attrs:{open:t.openTime},on:{"update:open":function(e){t.openTime=e}}},[i("mu-list",{on:{"item-click":t.closeBottomSheetTime}},[i("van-datetime-picker",{attrs:{type:"date","min-date":t.minDate},on:{confirm:t.confirmTime,cancel:t.close},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1)],1)],1)],1)]),t._v(" "),i("van-overlay",{staticClass:"overlay",attrs:{show:t.showover},on:{click:function(e){t.showover=!1}}},[i("van-loading",{attrs:{type:"spinner",color:"#1989fa"}})],1)],1)},staticRenderFns:[]};var C=i("VU/8")(p,w,!1,function(t){i("q/cH")},"data-v-edadc66a",null);e.default=C.exports},"q/cH":function(t,e){}});
//# sourceMappingURL=31.c56b121582d4148749f3.js.map