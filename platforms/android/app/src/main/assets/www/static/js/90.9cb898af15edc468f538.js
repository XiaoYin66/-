webpackJsonp([90],{bxI2:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Xxa5"),n=a.n(s),r=a("exGp"),o=a.n(r),i=a("M5WX"),c=a("Fd2+");a("7+uW").default.use(c.J);var u=document.documentElement.clientHeight||document.body.clientHeight,l=Math.floor((u-320)/40)-3,d={data:function(){return{status:this.$store.state.taskStatus,TaskList:[],TaskHistoryList:[{gmtCreate:"2019-09-01 11:00:00"}],token:"",currentPage:1,open:!1}},methods:{queryBtn:function(){this.open=!0},closeBottomSheet:function(){this.open=!1},initHistoryList:function(){var t=this;return o()(n.a.mark(function e(){var a,s,r,o,c,u,d;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a="/mobile/routing",s="",r="",o=t.currentPage,c=l-1,u=t.$route.query.carId,e.next=8,i.a.request(a,"GET",{endTime:s,startTime:r,vehicleId:u,pageNum:o,pageSize:c},t.token);case 8:d=e.sent,console.log(d),t.TaskHistoryList=d.data.data.rows;case 11:case"end":return e.stop()}},e,t)}))()},changePage:function(t){console.log(t),this.currentPage=t,this.initHistoryList()},btnTo:function(t){this.$router.push({path:"/carMapLine",query:{routingName:t}})},btnNextNavigate:function(){this.$router.push({path:"/CarTasks",query:{taskId:1}})},closeThis:function(t){var e=this;c.l.confirm({title:"",message:"确认删除当前创建的线路？"}).then(function(t){e.TaskList.splice(t,1),e.deleteData(),e.$store.state.taskStatus=0,e.$router.go(-1)}).catch(function(){})},deleteData:function(){var t=this;return o()(n.a.mark(function e(){var a,s,r,o;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=t,console.log("routingName",t.$route.query.id),s="/mobile/routing",r=t.$route.query.id,o={routingName:r},t.$http.delete(s,{params:o}).then(function(t){console.log(t),a.status=0,"success"===t.data.message&&(Object(c.J)("当前路线已经删除,请返回重新穿建路线"),a.$store.state.taskStatus=0)}).catch(function(t){console.log(t)});case 6:case"end":return e.stop()}},e,t)}))()},onClose:function(t,e,a){switch(t){case"left":case"cell":case"outside":e.close();break;case"right":c.l.confirm({message:"确定删除吗？"}).then(function(t){console.log(e)})}},initData:function(){var t=this;return o()(n.a.mark(function e(){var a,s,r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t.$route.query.carId),a="/mobile/point/data",s=t.$route.query.carId,e.next=5,i.a.request(a,"get",{vehicleId:s},t.token);case 5:r=e.sent,console.log("res",r),"success"===r.data.message&&t.$store.commit("enterpriseData",r.data.pollutantSource);case 8:case"end":return e.stop()}},e,t)}))()},filterData:function(t,e){console.log(e);for(var a=0;a<t.length;a++){if(e===t[a].routingName)return console.log(t[a]),t[a]}}},mounted:function(){var t=this;return o()(n.a.mark(function e(){var a,s,r,o;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.TaskList=[],t.token=sessionStorage.getItem("token"),t.initData(),1!==t.$store.state.taskStatus){e.next=8;break}t.TaskList=[],t.TaskList.push(t.$store.state.onlineTask),e.next=21;break;case 8:return a=[],s=t.$route.query.id,r="/mobile/routing/app",e.next=13,i.a.request(r,"get",{},t.token);case 13:return o=e.sent,console.log(o),e.next=17,t.filterData(o.data.data,s);case 17:a=e.sent,t.TaskList.push(a),console.log("list",a),t.$store.state.taskStatus=1;case 21:setTimeout(function(){t.initHistoryList()},1e3);case 22:case"end":return e.stop()}},e,t)}))()}},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-nav-bar",{staticClass:"backgroundNaviBar",attrs:{fixed:!0,title:"任务上传","left-arrow":"","z-index":"999",border:!1},on:{"click-left":function(){t.$router.go(-1)}}}),t._v(" "),a("div",{staticClass:"content"},[a("div",{staticClass:"headerCont border-radius"},[t._m(0),t._v(" "),t._l(t.TaskList,function(e,s){return a("van-swipe-cell",{key:s},[a("van-cell-group",{staticStyle:{"border-radius":"10px"},on:{click:t.btnNextNavigate}},[a("van-cell",{staticStyle:{"border-radius":"10px"},attrs:{title:e.vehicleId,label:e.gmtCreate}})],1),t._v(" "),a("template",{slot:"right"},[a("van-button",{staticClass:"flex",attrs:{square:"",type:"danger",text:"删除"},on:{click:function(e){return t.closeThis(s)}}})],1)],2)})],2)]),t._v(" "),a("mu-container",[a("mu-bottom-sheet",{attrs:{open:t.open},on:{"update:open":function(e){t.open=e}}},[a("mu-list",{on:{"item-click":t.closeBottomSheet}},[a("mu-list-item")],1)],1)],1)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"flexContTitle"},[e("div",{staticClass:"imgSize"}),this._v(" "),e("div",{staticClass:"taskTitle"},[e("span",{staticClass:"borderLeft"},[this._v("最新任务列表")])])])}]};var h=a("VU/8")(d,f,!1,function(t){a("lyS+")},"data-v-0b477fc8",null);e.default=h.exports},"lyS+":function(t,e){}});
//# sourceMappingURL=90.9cb898af15edc468f538.js.map